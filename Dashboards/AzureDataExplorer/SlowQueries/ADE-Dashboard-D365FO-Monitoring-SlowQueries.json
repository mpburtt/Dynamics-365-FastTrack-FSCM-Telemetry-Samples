{"$schema":"https://dataexplorer.azure.com/static/d/schema/63/dashboard.json","id":"dfceb705-0f4f-4ff9-881b-69d05ec01d83","eTag":"8e70d17b-f0dc-49e8-8bcf-6f9c8ee9b83f","title":"FSCM-SlowQueries-TST","tiles":[{"id":"e2c8ac0b-7ccb-4a47-9930-a1214ff41d44","title":"Slow queries reported by AOS (Top 100)","visualType":"table","pageId":"57b9f821-760e-45d0-82ee-71fb8dc71d79","layout":{"x":0,"y":9,"width":24,"height":8},"queryRef":{"kind":"query","queryId":"ec188563-23c9-4953-bf65-a714dcb0be30"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"5809a22f-397a-4bd8-9ca2-70c06894ba39","title":"Slow queries over time","visualType":"timechart","pageId":"57b9f821-760e-45d0-82ee-71fb8dc71d79","layout":{"x":0,"y":0,"width":8,"height":9},"queryRef":{"kind":"query","queryId":"de7bd8c6-b850-40b4-9891-52036e7faf08"},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"","xColumn":null,"yColumns":null,"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"legendLocation":"bottom","drillthrough":[],"selectedDataOnLoad":{"all":true,"limit":10},"dataPointsTooltip":{"all":false,"limit":1}}},{"id":"82e3f98d-f79f-4611-8b7e-c559d88927f0","title":"Slow queries by query type","visualType":"column","pageId":"57b9f821-760e-45d0-82ee-71fb8dc71d79","layout":{"x":8,"y":0,"width":8,"height":9},"queryRef":{"kind":"query","queryId":"a5d10e89-daa0-4f13-86bf-fb523122e8b4"},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"Number of queries","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"Query Type","xColumn":null,"yColumns":null,"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":true,"crossFilter":[{"interaction":"column","property":"Query Type","parameterId":"f9cae1c1-10c8-4ab1-ada6-e1a7b0cb675d","disabled":false}],"legendLocation":"bottom","drillthrough":[],"selectedDataOnLoad":{"all":true,"limit":10},"dataPointsTooltip":{"all":false,"limit":1}}},{"id":"06cc23e1-c57c-401e-977b-c6b22b9d7963","title":"Slow queries by client country / city","visualType":"column","pageId":"57b9f821-760e-45d0-82ee-71fb8dc71d79","layout":{"x":16,"y":0,"width":8,"height":9},"queryRef":{"kind":"query","queryId":"631f5478-a58f-4373-bc44-890dba0762fe"},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"Number of queries","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"Query Type","xColumn":null,"yColumns":null,"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[{"interaction":"column","property":"Client City","parameterId":"b1c9bd85-d46b-4eb4-981f-e3489fb7c4a1","disabled":false},{"disabled":false}],"legendLocation":"bottom","drillthrough":[],"selectedDataOnLoad":{"all":true,"limit":10},"dataPointsTooltip":{"all":false,"limit":1}}},{"id":"b053ab8c-0996-410b-92a0-84c625fe1135","title":"Top 25 slow queries by duration","visualType":"table","pageId":"57b9f821-760e-45d0-82ee-71fb8dc71d79","layout":{"x":0,"y":17,"width":24,"height":8},"queryRef":{"kind":"query","queryId":"a98a59e9-8d35-4a6e-a87a-0bcad08b010c"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}}],"dataSources":[{"id":"99f48c40-4d08-4070-af47-32e2e6e0fda7","kind":"manual-kusto","scopeId":"kusto","name":"FSCM TEST","clusterUri":"https://ade.applicationinsights.io/subscriptions/bc1d0969-7db8-4768-be23-b2ed191e0250/resourceGroups/rg-bprservices-we-fno-montel-uat","database":"appinsight-bprservices-we-fno-montel-uat"}],"schema_version":63,"baseQueries":[],"parameters":[{"kind":"duration","id":"42794f52-6782-487c-b413-b6b565549995","displayName":"Time range","description":"","beginVariableName":"_startTime","endVariableName":"_endTime","defaultValue":{"kind":"dynamic","count":1,"unit":"hours"},"showOnPages":{"kind":"all"}},{"kind":"string","id":"f9cae1c1-10c8-4ab1-ada6-e1a7b0cb675d","displayName":"Query Type","description":"","variableName":"_queryType","selectionType":"array","includeAllOption":true,"defaultValue":{"kind":"all"},"dataSource":{"kind":"query","columns":{"value":"QueryType"},"queryRef":{"kind":"query","queryId":"645246cd-b205-49f0-a12b-b7a823d2df40"}},"showOnPages":{"kind":"selection","pageIds":["57b9f821-760e-45d0-82ee-71fb8dc71d79"]}},{"kind":"string","id":"b1c9bd85-d46b-4eb4-981f-e3489fb7c4a1","displayName":"City","description":"","variableName":"_city","selectionType":"array","includeAllOption":true,"defaultValue":{"kind":"all"},"dataSource":{"kind":"query","columns":{"value":"client_City"},"queryRef":{"kind":"query","queryId":"11110b0a-b82d-4d1c-84ac-a72734b30b79"}},"showOnPages":{"kind":"selection","pageIds":["57b9f821-760e-45d0-82ee-71fb8dc71d79"]}},{"kind":"string","id":"87b51758-db25-4488-af2b-a8cdd494c438","displayName":"Environment","description":"","variableName":"_environmentId","selectionType":"array","includeAllOption":true,"defaultValue":{"kind":"all"},"dataSource":{"kind":"query","columns":{"value":"environmentId"},"queryRef":{"kind":"query","queryId":"f187cdc9-24a2-4f42-9f15-a56b52de31a1"},"autoReset":true},"showOnPages":{"kind":"all"}}],"pages":[{"name":"Slow Queries","id":"57b9f821-760e-45d0-82ee-71fb8dc71d79"}],"queries":[{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp  between (_startTime .. _endTime)\n| where name == \"LongRunningQuery\"\n| where isempty(['_city']) or client_City in (['_city'])\n| extend    EnvironmentId   = tostring(customDimensions.environmentId)\n| where     EnvironmentId in (_environmentId) or isempty(_environmentId)\n| extend LegalEntity            = customDimensions.LegalEntity\n    ,   ExecutionMode           = customDimensions.ExecutionMode\n    ,   ExecutionTimeSeconds    = customDimensions.ExecutionTimeSeconds\n    ,   CallStack               = customDimensions.CallStack\n    ,   QueryType               = customDimensions.QueryType\n    ,   Success                 = customDimensions.Success\n    ,   JoinCount               = customDimensions.JoinCount\n    ,   ReturnedRowCount        = customDimensions.ReturnedRowCount\n| where isempty(['_queryType']) or QueryType in (['_queryType'])\n| limit 100\n| project [\"Timestamp\"]             = timestamp\n        , [\"Environment\"]           = EnvironmentId\n        , [\"Session ID\"]            = session_Id\n        , [\"User ID\"]               = user_Id\n        , [\"Legal Entity\"]          = LegalEntity\n        , [\"Execution Mode\"]        = ExecutionMode\n        , [\"Query Type\"]            = QueryType\n        , [\"Execution Time (s)\"]    = ExecutionTimeSeconds\n        , [\"Join Count\"]            = JoinCount\n        , [\"Returned Row Count\"]    = ReturnedRowCount\n        , Success, CallStack \n        , [\"Client City\"]           = client_City\n        , [\"Client Country\"]        = client_CountryOrRegion","id":"ec188563-23c9-4953-bf65-a714dcb0be30","usedVariables":["_city","_endTime","_environmentId","_queryType","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp  between (_startTime .. _endTime)\n| where name == \"LongRunningQuery\"\n| where isempty(['_city']) or client_City in (['_city'])\n| extend    EnvironmentId   = tostring(customDimensions.environmentId)\n| where     EnvironmentId in (_environmentId) or isempty(_environmentId)\n| extend LegalEntity            = customDimensions.LegalEntity\n    ,   ExecutionMode           = customDimensions.ExecutionMode\n    ,   ExecutionTimeSeconds    = customDimensions.ExecutionTimeSeconds\n    ,   CallStack               = customDimensions.CallStack\n    ,   QueryType               = customDimensions.QueryType\n    ,   Success                 = customDimensions.Success\n    ,   JoinCount               = customDimensions.JoinCount\n    ,   ReturnedRowCount        = customDimensions.ReturnedRowCount\n| where isempty(['_queryType']) or QueryType  in (['_queryType'])\n| project [\"Timestamp\"]             = timestamp\n        , [\"Environment\"]           = EnvironmentId\n        , [\"Name\"]                  = name\n        , [\"Session ID\"]            = session_Id\n        , [\"User ID\"]               = user_Id\n        , [\"Legal Entity\"]          = LegalEntity\n        , [\"Execution Mode\"]        = ExecutionMode\n        , [\"Query Type\"]            = QueryType\n        , [\"Execution Time (s)\"]    = ExecutionTimeSeconds\n        , [\"Join Count\"]            = JoinCount\n        , [\"Returned Row Count\"]    = ReturnedRowCount\n        , Success, CallStack \n        , [\"Client City\"]           = client_City\n        , [\"Client Country\"]        = client_CountryOrRegion\n| summarize [\"Slow Queries\"] = count() by bin(Timestamp, 1h)","id":"de7bd8c6-b850-40b4-9891-52036e7faf08","usedVariables":["_city","_endTime","_environmentId","_queryType","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp  between (_startTime .. _endTime)\n| where name == \"LongRunningQuery\"\n| extend    EnvironmentId   = tostring(customDimensions.environmentId)\n| where     EnvironmentId in (_environmentId) or isempty(_environmentId)\n| where isempty(['_city']) or client_City in (['_city'])\n| extend LegalEntity            = customDimensions.LegalEntity\n    ,   ExecutionMode           = customDimensions.ExecutionMode\n    ,   ExecutionTimeSeconds    = customDimensions.ExecutionTimeSeconds\n    ,   CallStack               = customDimensions.CallStack\n    ,   QueryType               = customDimensions.QueryType\n    ,   Success                 = customDimensions.Success\n    ,   JoinCount               = customDimensions.JoinCount\n    ,   ReturnedRowCount        = customDimensions.ReturnedRowCount\n| project [\"Timestamp\"]             = timestamp\n        , [\"Environment\"]           = EnvironmentId\n        , [\"Name\"]                  = name\n        , [\"Session ID\"]            = session_Id\n        , [\"User ID\"]               = user_Id\n        , [\"Legal Entity\"]          = LegalEntity\n        , [\"Execution Mode\"]        = ExecutionMode\n        , [\"Query Type\"]            = tostring(QueryType)\n        , [\"Execution Time (s)\"]    = ExecutionTimeSeconds\n        , [\"Join Count\"]            = JoinCount\n        , [\"Returned Row Count\"]    = ReturnedRowCount\n        , Success, CallStack \n        , [\"Client City\"]           = client_City\n        , [\"Client Country\"]        = client_CountryOrRegion\n| summarize [\"Slow Queries\"] = count() by ['Query Type']\n","id":"a5d10e89-daa0-4f13-86bf-fb523122e8b4","usedVariables":["_city","_endTime","_environmentId","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp  between (_startTime .. _endTime)\n| where name == \"LongRunningQuery\"\n| extend    EnvironmentId   = tostring(customDimensions.environmentId)\n| where     EnvironmentId in (_environmentId) or isempty(_environmentId)\n| extend LegalEntity            = customDimensions.LegalEntity\n    ,   ExecutionMode           = customDimensions.ExecutionMode\n    ,   ExecutionTimeSeconds    = customDimensions.ExecutionTimeSeconds\n    ,   CallStack               = customDimensions.CallStack\n    ,   QueryType               = customDimensions.QueryType\n    ,   Success                 = customDimensions.Success\n    ,   JoinCount               = customDimensions.JoinCount\n    ,   ReturnedRowCount        = customDimensions.ReturnedRowCount\n| where isempty(['_queryType']) or QueryType in (['_queryType'])\n| project [\"Timestamp\"]             = timestamp\n        , [\"Environment\"]           = EnvironmentId\n        , [\"Name\"]                  = name\n        , [\"Session ID\"]            = session_Id\n        , [\"User ID\"]               = user_Id\n        , [\"Legal Entity\"]          = LegalEntity\n        , [\"Execution Mode\"]        = ExecutionMode\n        , [\"Query Type\"]            = tostring(QueryType)\n        , [\"Execution Time (s)\"]    = ExecutionTimeSeconds\n        , [\"Join Count\"]            = JoinCount\n        , [\"Returned Row Count\"]    = ReturnedRowCount\n        , Success, CallStack \n        , [\"Client City\"]           = client_City\n        , [\"Client Country\"]        = client_CountryOrRegion\n| summarize [\"Slow Queries\"] = count() by ['Client Country'], ['Client City']\n","id":"631f5478-a58f-4373-bc44-890dba0762fe","usedVariables":["_endTime","_environmentId","_queryType","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp  between (_startTime .. _endTime)\n| where name == \"LongRunningQuery\"\n| extend    EnvironmentId   = tostring(customDimensions.environmentId)\n| where     EnvironmentId in (_environmentId) or isempty(_environmentId)\n| where isempty(['_city']) or client_City in (['_city'])\n| extend LegalEntity            = tostring(customDimensions.LegalEntity)\n    ,   ExecutionMode           = tostring(customDimensions.ExecutionMode)\n    ,   ExecutionTimeSeconds    = tostring(customDimensions.ExecutionTimeSeconds)\n    ,   CallStack               = tostring(customDimensions.CallStack)\n    ,   QueryType               = tostring(customDimensions.QueryType)\n    ,   Success                 = tostring(customDimensions.Success)\n    ,   JoinCount               = tostring(customDimensions.JoinCount)\n    ,   ReturnedRowCount        = tostring(customDimensions.ReturnedRowCount)\n| where isempty(['_queryType']) or QueryType in (['_queryType'])\n| order by ExecutionTimeSeconds desc\n| limit 25\n| project [\"Timestamp\"]             = timestamp\n        , [\"Environment\"]           = EnvironmentId\n        , [\"Session ID\"]            = session_Id\n        , [\"User ID\"]               = user_Id\n        , [\"Legal Entity\"]          = LegalEntity\n        , [\"Execution Mode\"]        = ExecutionMode\n        , [\"Query Type\"]            = QueryType\n        , [\"Execution Time (s)\"]    = ExecutionTimeSeconds\n        , [\"Join Count\"]            = JoinCount\n        , [\"Returned Row Count\"]    = ReturnedRowCount\n        , Success, CallStack \n        , [\"Client City\"]           = client_City\n        , [\"Client Country\"]        = client_CountryOrRegion","id":"a98a59e9-8d35-4a6e-a87a-0bcad08b010c","usedVariables":["_city","_endTime","_environmentId","_queryType","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp between (_startTime .. _endTime)\n| where name == \"LongRunningQuery\"\n| project QueryType = tostring(customDimensions.QueryType)\n| distinct QueryType","id":"645246cd-b205-49f0-a12b-b7a823d2df40","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"customEvents\n| where timestamp between (_startTime .. _endTime)\n| where name == 'LongRunningQuery'\n| distinct client_City\n","id":"11110b0a-b82d-4d1c-84ac-a72734b30b79","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"99f48c40-4d08-4070-af47-32e2e6e0fda7"},"text":"pageViews\n| union exceptions\n| union customEvents\n| union customMetrics\n| union traces\n| where timestamp  between (_startTime .. _endTime)\n| extend Dims = parse_json(customDimensions)\n| extend environmentId = tostring(Dims.environmentId)\n| summarize by environmentId\n| where environmentId != \"\"","id":"f187cdc9-24a2-4f42-9f15-a56b52de31a1","usedVariables":["_endTime","_startTime"]}]}